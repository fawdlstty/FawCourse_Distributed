# 第二章 通信协议

微服务间的通讯将必然涉及到通讯协议，所以在实际项目开发上，有必要了解不同的协议类型分别适用于哪些不同的场景。

## HTTP/1.1

这个协议是目前网络中使用最广泛的协议，主要原因之一是兼容所有浏览器或所有 HTTP 库，支持非常广泛，之二是 HTTP/2 标准诞生较晚，给了 HTTP/1.1 充足的发展时间，使得它一家独大。

目前绝大部分 REST API 与 RPC 协议使用它或者使用 HTTP over SSL(HTTPS) 来实现，所以这也是最应该完全掌握的协议之一。

优点：

* 兼容性好
* 扩展性好
* 使用广泛

缺点：

* 由于基于TCP协议，所以对较小但频率较高的数据包的流量控制做的不好  
  原因是TCP协议的主要流量控制算法为“慢加载”，也就是最开始发少量数据包，全部准确到达后数据量*2，然后一直循环，直到达到网络的负载，这时候根据丢包率来控制实际传输量。所以下载文件的时候经常有这样的现象：刚下载时比较慢，几秒钟后依次递增。对于一次性传输大量数据没问题，但需要多次传输少量数据就会使得这种方式成为制约通信的最大的问题
* HTTP/1.1 是一种半双工通信协议，使得对服务器主动通知客户端的实现不太好（主要指的是轮询），虽然有扩展协议websocket可以实现，但这个协议不能复用tcp管道，如果有多个链接那么将会创建多个TCP链接，存在前面提到的  
  第一个字半指的不能随意的发送和接收（全指的就是能随时发送和接收），双工指的就是发送和接收（单工指的只能发送或者只能接收）
* 明文协议安全性不佳，虽然可以通过 SSL 管道来加密信息，但 TCP 三握手 + SSL 四握手使得链接建立缓慢
* 协议本身是针对 Web 开发而设计，用于 REST RPC 请求来说比较浪费空间，虽然协议本身支持压缩（非标准请求压缩，因为不确定服务器是否支持解析压缩的请求；标准响应压缩），但依旧使得空间的浪费

## HTTP/2
